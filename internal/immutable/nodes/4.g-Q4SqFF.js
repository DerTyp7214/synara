import{f as d,a as n,c as le}from"../chunks/BUB_SVW2.js";import{p as ie,c as ne,g as a,s as u,t as m,d as oe,f as T,h as o,i as l,j as i,k as s,l as de}from"../chunks/CYChEm4a.js";import{s as p}from"../chunks/DwYNeIeS.js";import{i as f}from"../chunks/DOcNpZnL.js";import{s as j,e as ce,i as ue}from"../chunks/mok4srEe.js";import{p as v}from"../chunks/COU2P81D.js";var me=d('<div class="badge preset-filled-surface"> </div>'),pe=d('<div class="placeholder animate-pulse h-10 w-full rounded-token"></div>'),fe=d('<a target="_blank" rel="noopener noreferrer" class="btn preset-tonal"> </a>'),ve=d('<div class="grid grid-cols-2 gap-2 w-full"></div>'),he=d('<a target="_blank" rel="noopener noreferrer" class="btn preset-tonal w-full">View on MusicBrainz</a>'),ge=d('<div class="text-xs opacity-50 font-mono mt-2 break-all"> </div>'),_e=d('<div class="relative min-h-screen w-full flex items-center justify-center overflow-hidden bg-surface-900"><div class="absolute w-150 h-150 bg-primary-500/20 blur-[120px] rounded-full top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none"></div> <div class="absolute inset-0 pointer-events-none bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.1)_50%)] bg-size-[100%_4px] z-10"></div> <div class="container mx-auto p-4 flex flex-col items-center justify-center relative z-20"><div class="card p-8 w-full max-w-2xl bg-surface-100-800-token shadow-xl space-y-6 text-center border border-surface-200-700-token rounded-container-token backdrop-blur-sm bg-opacity-90 dark:bg-opacity-90"><h1 class="h3 font-bold uppercase tracking-widest opacity-60">Shared Track</h1> <div class="space-y-2"><h2 class="h1 font-bold text-primary-500"> </h2> <p class="h3 text-surface-600-300-token"> </p></div> <!> <div class="flex flex-col gap-3 w-full pt-4"><a class="btn preset-filled-primary-500 font-bold w-full shadow-lg shadow-primary-500/20">Open in Synara</a> <!> <!></div> <!></div></div></div>');function ze(V,q){ie(q,!0);let D=i(()=>v.url.searchParams.get("title")??"Unknown Title"),b=i(()=>v.url.searchParams.getAll("artist")),O=i(()=>v.url.searchParams.get("duration")),h=i(()=>v.url.searchParams.get("mbid")),c=T(null),k=T(null),g=T(!1);ne(()=>{const r=[a(D),...a(b)].join(" ");r.trim()&&(u(g,!0),fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(r)}&entity=song&limit=1`).then(e=>e.json()).then(e=>{if(e.results&&e.results.length>0){u(c,e.results[0],!0);const t=a(c).trackViewUrl;return fetch(`https://api.song.link/v1-alpha.1/links?url=${encodeURIComponent(t)}`)}else return console.warn("Track not found on iTunes"),null}).then(e=>e?e.json():null).then(e=>{u(k,e,!0),u(g,!1)}).catch(e=>{console.error("Failed to fetch streaming links",e),u(g,!1)}))});let Y=i(()=>a(c)?.trackName??a(D)),E=i(()=>a(c)?.artistName??(a(b).length>0?a(b).join(", "):"Unknown Artist"));function U(r){const e=Math.floor(r/6e4),t=(r%6e4/1e3).toFixed(0);return e+":"+(Number(t)<10?"0":"")+t}let A=i(()=>a(c)?.trackTimeMillis?U(a(c).trackTimeMillis):U(Number(a(O))??0)),B=i(()=>a(k)?.linksByPlatform?[{id:"spotify",name:"Spotify"},{id:"appleMusic",name:"Apple Music"},{id:"youtubeMusic",name:"YouTube Music"},{id:"soundcloud",name:"SoundCloud"},{id:"deezer",name:"Deezer"},{id:"tidal",name:"Tidal"},{id:"bandcamp",name:"Bandcamp"},{id:"napster",name:"Napster"},{id:"amazonMusic",name:"Amazon Music"}].map(e=>{const t=a(k).linksByPlatform[e.id];return t?{name:e.name,url:t.url}:null}).filter(e=>e!==null):[]),G=i(()=>`synara://share${v.url.search}`),N=i(()=>a(h)?`https://musicbrainz.org/recording/${a(h)}`:null);var x=_e(),S=o(l(x),4),$=l(S),y=o(l($),2),w=l(y),H=l(w,!0);s(w);var C=o(w,2),J=l(C,!0);s(C),s(y);var I=o(y,2);{var K=r=>{var e=me(),t=l(e);s(e),m(()=>p(t,`Duration: ${a(A)??""}`)),n(r,e)};f(I,r=>{a(A)&&r(K)})}var M=o(I,2),F=l(M),L=o(F,2);{var Q=r=>{var e=pe();n(r,e)},W=r=>{var e=le(),t=de(e);{var re=z=>{var P=ve();ce(P,21,()=>a(B),ue,(te,R)=>{var _=fe(),se=l(_,!0);s(_),m(()=>{j(_,"href",a(R).url),p(se,a(R).name)}),n(te,_)}),s(P),n(z,P)};f(t,z=>{a(B).length>0&&z(re)},!0)}n(r,e)};f(L,r=>{a(g)?r(Q):r(W,!1)})}var X=o(L,2);{var Z=r=>{var e=he();m(()=>j(e,"href",a(N))),n(r,e)};f(X,r=>{a(N)&&r(Z)})}s(M);var ee=o(M,2);{var ae=r=>{var e=ge(),t=l(e);s(e),m(()=>p(t,`MBID: ${a(h)??""}`)),n(r,e)};f(ee,r=>{a(h)&&r(ae)})}s($),s(S),s(x),m(()=>{p(H,a(Y)),p(J,a(E)),j(F,"href",a(G))}),n(V,x),oe()}export{ze as component};
