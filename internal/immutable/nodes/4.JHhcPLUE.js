import{f as d,a as i,c as ne}from"../chunks/BUB_SVW2.js";import{p as le,c as ie,g as e,s as m,t as f,d as oe,f as T,h as o,i as n,j as l,k as s,l as de}from"../chunks/CYChEm4a.js";import{s as v}from"../chunks/DwYNeIeS.js";import{i as h}from"../chunks/DOcNpZnL.js";import{s as j,e as ce,i as ue}from"../chunks/mok4srEe.js";import{p as g}from"../chunks/BJGBsEn3.js";var pe=d('<div class="badge preset-filled-surface"> </div>'),me=d('<div class="placeholder animate-pulse h-10 w-full rounded-token"></div>'),fe=d('<a target="_blank" rel="noopener noreferrer" class="btn preset-tonal"> </a>'),ve=d('<div class="grid grid-cols-2 gap-2 w-full"></div>'),he=d('<a target="_blank" rel="noopener noreferrer" class="btn preset-tonal w-full">View on MusicBrainz</a>'),ge=d('<div class="text-xs opacity-50 font-mono mt-2 break-all"> </div>'),_e=d('<div class="relative min-h-screen w-full flex items-center justify-center overflow-hidden bg-surface-900"><div class="absolute w-150 h-150 bg-primary-500/20 blur-[120px] rounded-full top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none"></div> <div class="absolute inset-0 pointer-events-none bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.1)_50%)] bg-size-[100%_4px] z-10"></div> <div class="container mx-auto p-4 flex flex-col items-center justify-center relative z-20"><div class="card p-8 w-full max-w-2xl bg-surface-100-800-token shadow-xl space-y-6 text-center border border-surface-200-700-token rounded-container-token backdrop-blur-sm bg-opacity-90 dark:bg-opacity-90"><h1 class="h3 font-bold uppercase tracking-widest opacity-60">Shared Track</h1> <div class="space-y-2"><h2 class="h1 font-bold text-primary-500"> </h2> <p class="h3 text-surface-600-300-token"> </p></div> <!> <div class="flex flex-col gap-3 w-full pt-4"><a class="btn preset-filled-primary-500 font-bold w-full shadow-lg shadow-primary-500/20">Open in Synara</a> <!> <!></div> <!></div></div></div>');function Ue(q,O){le(O,!0);let D=l(()=>g.url.searchParams.get("title")??"Unknown Title"),x=l(()=>g.url.searchParams.getAll("artist")),Y=l(()=>g.url.searchParams.get("duration")),_=l(()=>g.url.searchParams.get("mbid")),c=T(null),y=T(null),b=T(!1);ie(()=>{const a=[e(D),...e(x)].join(" ");if(a.trim()){m(b,!0);const r=`https://itunes.apple.com/search?term=${encodeURIComponent(a)}&entity=song&limit=1`;fetch(r).then(t=>t.json()).then(t=>{if(t.results&&t.results.length>0){m(c,t.results[0],!0);const P=e(c).trackViewUrl,u=`https://api.song.link/v1-alpha.1/links?url=${encodeURIComponent(P)}`,p=`https://api.allorigins.win/raw?url=${encodeURIComponent(u)}`;return fetch(p)}else return console.warn("Track not found on iTunes"),null}).then(t=>t?t.json():null).then(t=>{m(y,t,!0),m(b,!1)}).catch(t=>{console.error("Failed to fetch streaming links",t),m(b,!1)})}});let E=l(()=>e(c)?.trackName??e(D)),G=l(()=>e(c)?.artistName??(e(x).length>0?e(x).join(", "):"Unknown Artist"));function A(a){const r=Math.floor(a/6e4),t=(a%6e4/1e3).toFixed(0);return r+":"+(Number(t)<10?"0":"")+t}let B=l(()=>e(c)?.trackTimeMillis?A(e(c).trackTimeMillis):A(Number(e(Y))??0)),N=l(()=>e(y)?.linksByPlatform?[{id:"spotify",name:"Spotify"},{id:"appleMusic",name:"Apple Music"},{id:"youtubeMusic",name:"YouTube Music"},{id:"soundcloud",name:"SoundCloud"},{id:"deezer",name:"Deezer"},{id:"tidal",name:"Tidal"},{id:"bandcamp",name:"Bandcamp"},{id:"napster",name:"Napster"},{id:"amazonMusic",name:"Amazon Music"}].map(r=>{const t=e(y).linksByPlatform[r.id];return t?{name:r.name,url:t.url}:null}).filter(r=>r!==null):[]),H=l(()=>`synara://share${g.url.search}`),$=l(()=>e(_)?`https://musicbrainz.org/recording/${e(_)}`:null);var w=_e(),C=o(n(w),4),I=n(C),M=o(n(I),2),U=n(M),J=n(U,!0);s(U);var S=o(U,2),K=n(S,!0);s(S),s(M);var R=o(M,2);{var Q=a=>{var r=pe(),t=n(r);s(r),f(()=>v(t,`Duration: ${e(B)??""}`)),i(a,r)};h(R,a=>{e(B)&&a(Q)})}var z=o(R,2),F=n(z),L=o(F,2);{var W=a=>{var r=me();i(a,r)},X=a=>{var r=ne(),t=de(r);{var P=u=>{var p=ve();ce(p,21,()=>e(N),ue,(te,V)=>{var k=fe(),se=n(k,!0);s(k),f(()=>{j(k,"href",e(V).url),v(se,e(V).name)}),i(te,k)}),s(p),i(u,p)};h(t,u=>{e(N).length>0&&u(P)},!0)}i(a,r)};h(L,a=>{e(b)?a(W):a(X,!1)})}var Z=o(L,2);{var ee=a=>{var r=he();f(()=>j(r,"href",e($))),i(a,r)};h(Z,a=>{e($)&&a(ee)})}s(z);var ae=o(z,2);{var re=a=>{var r=ge(),t=n(r);s(r),f(()=>v(t,`MBID: ${e(_)??""}`)),i(a,r)};h(ae,a=>{e(_)&&a(re)})}s(I),s(C),s(w),f(()=>{v(J,e(E)),v(K,e(G)),j(F,"href",e(H))}),i(q,w),oe()}export{Ue as component};
